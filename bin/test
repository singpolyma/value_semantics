#!/bin/bash
set -ue

MUTANT_PATTERN=${1:-ValueSemantics*}

# if $MUTATION_TEST is false, just run RSpec
if [[ "${MUTATION_TEST:-true}" == "false" ]] ; then
    bundle exec rspec
else
    # The ignored subjects crash mutant, and I don't want to deal with that
    bundle exec mutant \
        --include lib \
        --require value_semantics \
        --use rspec \
        --ignore-subject "ValueSemantics::Struct.new" \
        --ignore-subject "ValueSemantics::DSL#HashOf" \
        "$MUTANT_PATTERN"
fi
